<% if current_user.student? %>
<!-- topic tab -->
<div role="tabpanel" class="tab-pane active py-3" id="topic">
  <div class="row">
    <% @topic_categories.each do |category| %>
      <% if category.articles.count > 0 %>
        <div class="col-lg-3 my-2">
          <%= link_to category do %>
            <div class="card topic-card justify-content-between">
              <div class="card-name pt-1 pb-4">
                <%= category.title %>
              </div>
              <div class="card-bottom">
                <div class="card-progress">
                  <div class="row mx-0 justify-content-between">
                    <div class="read-text">
                      Gelesen
                    </div>
                    <div class="progress-percentage">
                      <%= '%.2f' % (((category.articles.published & @read_articles).count * 100) / (category.articles.published.count)) %>%
                    </div>
                  </div>
                  <progress class="w-100" value="<%= (category.articles.published & @read_articles).count %>" max="<%= (category.articles.published.count) %>"></progress>
                </div>
                <div class="card-stats row justify-content-between">
                  <div class="read-articles row mx-0 align-items-center">
                    <i class="material-icons-sharp stats-icon p-1">library_books</i>
                    <%= category.articles.count %>
                    Artikel
                  </div>
                  <div class="reading-time row mx-0 align-items-center">
                    <i class="material-icons-sharp stats-icon p-1">access_time</i>
                      <%= category.articles.count * 2.5 %>
                      min/Lesen
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
<!-- upcoming tab -->
<div role="tabpanel" class="tab-pane py-3 mh-100" id="upcoming">
  <div class="row">
    <% @upcoming_categories.each do |upcoming_category| %>
      <div class="col-lg-3 my-2">
        <%= link_to upcoming_category do %>
          <div class="card topic-card justify-content-between">
            <div class="card-name pt-1 pb-4">
              <%= upcoming_category.title %>
            </div>
            <div class="card-bottom">
              <div class="card-progress">
                <div class="row mx-0 justify-content-between">
                  <div class="read-text">
                    Gelesen
                  </div>
                  <div class="progress-percentage">
                    <%= '%.2f' % (((upcoming_category.articles.published & @read_articles).count * 100) / (upcoming_category.articles.published.count)) %>%
                  </div>
                </div>
                <progress class="w-100" value="<%= (upcoming_category.articles.published & @read_articles).count %>" max="<%= (upcoming_category.articles.published.count) %>"></progress>
              </div>
              <div class="card-stats row justify-content-between">
                <div class="read-articles row mx-0 align-items-center">
                  <i class="material-icons-sharp stats-icon p-1">library_books</i>
                  <%= upcoming_category.articles.count %>
                  Artikel
                </div>
                <div class="reading-time row mx-0 align-items-center">
                  <i class="material-icons-sharp stats-icon p-1">access_time</i>
                    <%= upcoming_category.articles.count * 2.5 %>
                    min/Lesen
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
<!-- bookmarked tab -->
<div role="tabpanel" class="tab-pane py-3 mh-100" id="bookmarked">
  <div class="row">
    <% @bookmarked_categories.each do |bookmarked_category| %>
      <div class="col-lg-3 my-2">
        <%= link_to bookmarked_category do %>
          <div class="card topic-card justify-content-between">
            <div class="card-name pt-1 pb-4">
              <%= bookmarked_category.title %>
            </div>
            <div class="card-bottom">
              <div class="card-progress">
                <div class="row mx-0 justify-content-between">
                  <div class="read-text">
                    Gelesen
                  </div>
                  <div class="progress-percentage">
                    <%= '%.2f' % (((bookmarked_category.articles.published & @read_articles).count * 100) / (bookmarked_category.articles.published.count)) %>%
                  </div>
                </div>
                <progress class="w-100" value="<%= (bookmarked_category.articles.published & @read_articles).count %>" max="<%= (bookmarked_category.articles.published.count) %>"></progress>
              </div>
              <div class="card-stats row justify-content-between">
                <div class="read-articles row mx-0 align-items-center">
                  <i class="material-icons-sharp stats-icon p-1">library_books</i>
                  <%= bookmarked_category.articles.count %>
                  Artikel
                </div>
                <div class="reading-time row mx-0 align-items-center">
                  <i class="material-icons-sharp stats-icon p-1">access_time</i>
                    <%= bookmarked_category.articles.count * 2.5 %>
                    min/Lesen
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
<!-- read tab -->
<div role="tabpanel" class="tab-pane py-3 mh-100" id="read">
  <div class="row">
    <% @read_categories.each do |read_category| %>
      <div class="col-lg-3 my-2">
        <%= link_to read_category do %>
          <div class="card topic-card justify-content-between">
            <div class="card-name pt-1 pb-4">
              <%= read_category.title %>
            </div>
            <div class="card-bottom">
              <div class="card-progress">
                <div class="row mx-0 justify-content-between">
                  <div class="read-text">
                    Gelesen
                  </div>
                  <div class="progress-percentage">
                    <%= '%.2f' % (((read_category.articles.published & @read_articles).count * 100) / (read_category.articles.published.count)) %>%
                  </div>
                </div>
                <progress class="w-100" value="<%= (read_category.articles.published & @read_articles).count %>" max="<%= (read_category.articles.published.count) %>"></progress>
              </div>
              <div class="card-stats row justify-content-between">
                <div class="read-articles row mx-0 align-items-center">
                  <i class="material-icons-sharp stats-icon p-1">library_books</i>
                  <%= read_category.articles.count %>
                  Artikel
                </div>
                <div class="reading-time row mx-0 align-items-center">
                  <i class="material-icons-sharp stats-icon p-1">access_time</i>
                    <%= read_category.articles.count * 2.5 %>
                    min/Lesen
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
<% elsif current_user.admin? || current_user.author? %>
  <div class="row mt-5">
    <div class="col">
      <h1 class="display-4">Categories</h1>
    </div>
  </div>
  <div class="row">
      <% @topic.categories.each do |category| %>
        <%= link_to category do %>
          <div class="col">
            <div class="card topic-card justify-content-between  mt-3">
              <div class="card-name pt-1 pb-3">
                <%= category.title %>
              </div>
              <% if current_user.admin? %>
                <%= link_to "Edit", edit_category_path(category), class: "btn btn-warning" %>
                <%= link_to "Delete", category_path(category), method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure?" } %>
              <% end %>
            </div>
          </div>
        <% end %>
      <% end %>
  </div>
<% end %>